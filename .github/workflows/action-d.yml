#

name: test github runner
on:
  push:
    paths:
      - "**action-d**"

jobs:
  setup_env:
    runs-on: [self-hosted, linux, x64]
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - name: setting up docker rootless
        run: docker context use rootless
  test_runner:
    runs-on: [self-hosted, linux, x64]
    needs: [setup_env]
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      - name: setting up docker rootless
        run: docker context use rootless
      - name: get pod
        uses: steebchen/kubectl@v2.0.0
        with:
          config: ${{ secrets.KUBE_CONFIG_DATA }}
          version: v1.21.0 # specify kubectl binary version explicitly
          command: get pods